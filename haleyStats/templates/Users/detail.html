{% extends 'base.html' %} {% block content %} {% load static %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"
></script>
<link rel="stylesheet" href="{% static 'User/detail.css' %}" />
<script type="text/javascript" src="{% static 'User/chart.js' %}"></script>


<div class="profile">
    <div class="jumbotron rounded-0 text-light {{ user.most_race }}">
        <h1 class="jumbotron-heading">
            <img class="icon rounded-circle {{ user.most_race }}" />
            {{ user.name }}
            <span class="h4 text-secondary">({{ user.most_race }})</span>
        </h1>
        <h3></h3>
        <small class="text-secondary">{{ user.joined_date }}에 가입</small>
    </div>
    <hr>
    <div class="h2 m-3">커리어</div>
    <div class="jumbotron rounded-0 ">
        {{ user.career }}
    </div>
</div>
<hr>

<div class="statistics-summary">
    <div class="h2 m-3">최근 전적 - 승률 : {{ winning_rate }}%&nbsp;{{ winning_status }}</div>
</div>

<div class="match-list">
    <ul class="list-group">
    {% for match in match_list %}
        <li class="list-group-item">
            <div class="d-flex justify-content-center align-items-center">
                <div class="mr-auto text-center" id="league">
                    <div class="h5">{{ match.league.name }}<br></div>
                    <small>{{ match.name }}</small>
                </div>
                <div class="" id="result">
                    {% for player in match.player_set.all %}
                        <a href="{{ player.user.get_absolute_url }}"
                           class="h3"
                           >{{ player.user.name }}&nbsp;                            
                            <span class="h4">
                                ({{ player.race }})
                            </span>
                        </a>
                        {% if player.is_win %}
                            <div class="badge badge-primary">승</div>
                        {% else %}
                            <div class="badge badge-danger">패</div>
                        {% endif %}
                        <br/>
                    {% endfor %}
                </div>
                &nbsp;
                <div class="" id="map">
                    <a href="{{ match.map.get_absolute_url }}">{{ match.map }}</a>
                </div>
                <div class="ml-auto text-secondary" id="date">
                    <small>{{ match.date }}</small>
                </div>
            </div>
        </li>
    {% endfor %}
    </ul>
    <!-- 
    <ul class="list-group">
            {% for match in match_list %}
            <li
                class="list-group-item 
                    {% for player in match.player_set.all %}
                        {% if player.user.name == user.name %}
                            {% if player.is_win %}
                                list-group-item-primary
                            {% else %}
                                list-group-item-danger
                            {% endif %}
                        {% endif %}
                    {% endfor %}"
            >
                <span class="h5"
                    >{{ match.league_name }}&nbsp;{{ match.name }}&nbsp;{{ match.set }}&nbsp;경기
                </span>
                <small class="text-secondary ml-3 mr-3">{{ match.date }}</small>
                <span class="h4">
                    {% for player in match.player_set.all %} 
                        <a href="{{ player.user.get_absolute_url }}"
                        >{{ player.user.name }}&nbsp;<span class="h6 text-secondary"
                            >({{ player.race }})</span></a>
                    {% endfor %}
                </span>
            </li>
        {% endfor %}

    </ul>
    -->
</div>
<hr>

<div class="statistics p-3">
    <div class="h2">
        종족별 승률
    </div>
    <div class="h4 row justify-content-center">
        <div class="col-md-4">
            <canvas id="pieChart"></canvas>
        </div>
    </div>
</div>
<script type="text/javascript">
new_chart("pieChart", '{{ winning_rate_by_race.keys }}', {{ winning_rate_by_race.values }});
{% for race, rates in winning_rate_by_race.items %}
{% endfor %}
</script>
{% endblock content %}